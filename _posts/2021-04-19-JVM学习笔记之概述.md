---
title: JVM学习笔记之概述
categories:
  - JVM
tags:
  - JVM
---

<!--more-->

# 前言 JVM整体结构
主流的是HotSpot虚拟机，所以下文内容都是针对HotSpot虚拟机。整体结构如下图所示，非常清晰明了，之后会详细介绍每一部分

![image.png](https://www.hualigs.cn/image/607d21d2dcf5d.jpg)

Java编译器输入的指令流是基于**栈的指令集架构**，另外一种指令集架构为基于**寄存器的指令集架构**。

基于栈的指令集架构特点：

- 设计和实现更简单，适用于资源受限的系统
- 避开了寄存器的分配难题：使用零地址指令方式分配
- 指令流中的指令大部分是零地址指令，其执行过程依赖于操作栈。指令集更小（指令多），编译器容易实现。
- 不需要硬件支持，可移植性更好，更好实现跨平台。

基于寄存器的指令集架构特点：

- 典型的应用是x86的二进制指令集：比如传统的PC以及安卓的Davlik虚拟机。
- 指令集架构则完全依赖硬件，可移植性差
- 性能优秀和指令更高效
- 花费更少的指令去完成一项操作
- 在大部分情况下，基于寄存器架构的指令集往往都以一地址指令、二地址指令和三地址指令为主，而基于栈的指令集确是以零地址指令为主

# JVM生命周期

## 虚拟机启动

Java虚拟机的启动是通过类加载器（bootstrap class loader)创建一个初始类(initial class)来完成的，这个类时由虚拟机的具体实现指定的。

## 虚拟机执行

- 一个运行中的Java虚拟机有着一个清晰的任务，执行Java程序
- 程序开始执行时才运行，程序结束时就停止
- 执行一个Java程序的时候，真正在执行的是一个叫做Java虚拟机的进程

## 虚拟机退出

如下情况会退出

- 程序正常执行结束
- 程序在执行过程中遇到了异常或错误而异常终止
- 由于操作系统出现错误而导致Java虚拟机进程终止
- 某线程调用Runtime类或System类的exit方法，或Runtime类的halt方法，并且Java安全管理器也允许这次exit或halt操作。
- 除此之外，JNI(Java Native Interface)规范描述了用JNI Invocation API来加载或卸载Java虚拟机时，Java虚拟机退出的情况。